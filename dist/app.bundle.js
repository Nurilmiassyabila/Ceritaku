/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var e={602:(e,t,n)=>{n.r(t),n.d(t,{deleteDB:()=>y,openDB:()=>v,unwrap:()=>d,wrap:()=>p});const r=(e,t)=>t.some(t=>e instanceof t);let o,a;const i=new WeakMap,c=new WeakMap,u=new WeakMap;let s={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function l(e){s=e(s)}function f(e){return"function"==typeof e?(t=e,(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(d(this),e),p(this.request)}:function(...e){return p(t.apply(d(this),e))}):(e instanceof IDBTransaction&&function(e){if(i.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)});i.set(e,t)}(e),r(e,o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,s):e);var t}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{t(p(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",a)});return u.set(t,e),t}(e);if(c.has(e))return c.get(e);const t=f(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const d=e=>u.get(e);function v(e,t,{blocked:n,upgrade:r,blocking:o,terminated:a}={}){const i=indexedDB.open(e,t),c=p(i);return r&&i.addEventListener("upgradeneeded",e=>{r(p(i.result),e.oldVersion,e.newVersion,p(i.transaction),e)}),n&&i.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),c.then(e=>{a&&e.addEventListener("close",()=>a()),o&&e.addEventListener("versionchange",e=>o(e.oldVersion,e.newVersion,e))}).catch(()=>{}),c}function y(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",e=>t(e.oldVersion,e)),p(n).then(()=>{})}const m=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],h=new Map;function g(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(h.get(t))return h.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=b.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!m.includes(n))return;const a=async function(e,...t){const a=this.transaction(e,o?"readwrite":"readonly");let i=a.store;return r&&(i=i.index(t.shift())),(await Promise.all([i[n](...t),o&&a.done]))[0]};return h.set(t,a),a}l(e=>({...e,get:(t,n,r)=>g(t,n)||e.get(t,n,r),has:(t,n)=>!!g(t,n)||e.has(t,n)}));const w=["continue","continuePrimaryKey","advance"],k={},S=new WeakMap,j=new WeakMap,P={get(e,t){if(!w.includes(t))return e[t];let n=k[t];return n||(n=k[t]=function(...e){S.set(this,j.get(this)[t](...e))}),n}};async function*O(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,P);for(j.set(n,t),u.set(n,d(t));t;)yield n,t=await(S.get(n)||t.continue()),S.delete(n)}function E(e,t){return t===Symbol.asyncIterator&&r(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&r(e,[IDBIndex,IDBObjectStore])}l(e=>({...e,get:(t,n,r)=>E(t,n)?O:e.get(t,n,r),has:(t,n)=>E(t,n)||e.has(t,n)}))}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function c(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return a(l,"_invoke",function(n,r,o){var a,i,c,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,c=e,p.n=n,u}};function d(n,r){for(i=n,c=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(i=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,i=0))}if(o||n>1)return u;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),i=l,c=v;(t=i<2?e:c)||!f;){a||(i?i<3?(i>1&&(p.n=-1),d(i,c)):p.n=c:p.v=c);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=p.n<0)?c:n.call(r,p))!==u)break}catch(t){a=e,i=1,c=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),l}var u={};function s(){}function l(){}function f(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(a(t={},r,function(){return this}),t),d=f.prototype=s.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,a(d,"constructor",f),a(f,"constructor",l),l.displayName="GeneratorFunction",a(f,i,"GeneratorFunction"),a(d),a(d,i,"Generator"),a(d,r,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:v}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){function i(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},a(e,t,n,r)}function i(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){i(a,r,o,c,u,"next",e)}function u(e){i(a,r,o,c,u,"throw",e)}c(void 0)})}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const l=new(function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.routes={},this.currentView=null,window.addEventListener("hashchange",function(){return t.handleRoute()}),window.addEventListener("DOMContentLoaded",function(){return t.handleRoute()})},t=[{key:"addRoute",value:function(e,t){this.routes[e]=t}},{key:"navigate",value:function(e){window.location.hash="#".concat(e)}},{key:"handleRoute",value:(n=c(o().m(function e(){var t,n,r,a,i,u,s,l=this;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=window.location.hash.replace("#","")||"/",n=this.routes[t],r=document.querySelector("#main-content")){e.n=1;break}return console.error("Elemen #main-content tidak ditemukan di index.html"),e.a(2);case 1:if(this.currentView&&"function"==typeof this.currentView.destroy)try{this.currentView.destroy()}catch(e){console.warn("Gagal membersihkan view sebelumnya:",e)}if(r.innerHTML="<p>Memuat halaman...</p>",!n){e.n=11;break}if("function"!=typeof document.startViewTransition){e.n=6;break}return e.p=2,e.n=3,document.startViewTransition(c(o().m(function e(){var t;return o().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,n();case 1:(t=e.v)&&t.view?l.currentView=t.view:l.currentView=null;case 2:return e.a(2)}},e)})));case 3:requestAnimationFrame(function(){r.setAttribute("tabindex","-1"),r.focus({preventScroll:!1})}),e.n=5;break;case 4:e.p=4,u=e.v,console.error("Gagal memuat route (startViewTransition):",u),r.innerHTML='<p class="error">Terjadi kesalahan saat memuat halaman.</p>';case 5:e.n=10;break;case 6:return e.p=6,r.classList.add("fade-out"),e.n=7,new Promise(function(e){return setTimeout(e,180)});case 7:return e.n=8,n();case 8:(a=e.v)&&a.view?this.currentView=a.view:this.currentView=null,r.classList.remove("fade-out"),r.classList.add("fade-in"),setTimeout(function(){return r.classList.remove("fade-in")},320),requestAnimationFrame(function(){r.setAttribute("tabindex","-1"),r.focus({preventScroll:!1})}),e.n=10;break;case 9:e.p=9,s=e.v,console.error("Gagal memuat route (fallback):",s),r.innerHTML='<p class="error">Terjadi kesalahan saat memuat halaman.</p>';case 10:e.n=12;break;case 11:r.innerHTML='\n        <section class="not-found">\n          <h2>404 - Halaman Tidak Ditemukan</h2>\n          <p>Halaman yang Anda cari tidak tersedia.</p>\n          <button id="back-home">Kembali ke Beranda</button>\n        </section>\n      ',(i=document.querySelector("#back-home"))&&i.addEventListener("click",function(){return l.navigate("/home")}),r.classList.remove("fade-out"),r.classList.add("fade-in"),setTimeout(function(){return r.classList.remove("fade-in")},320);case 12:return e.a(2)}},e,this,[[6,9],[2,4]])})),function(){return n.apply(this,arguments)})}],t&&u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return d(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(d(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,d(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,d(f,"constructor",s),d(s,"constructor",u),u.displayName="GeneratorFunction",d(s,o,"GeneratorFunction"),d(f),d(f,o,"Generator"),d(f,r,function(){return this}),d(f,"toString",function(){return"[object Generator]"}),(p=function(){return{w:a,m:v}})()}function d(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}d=function(e,t,n,r){function a(t,n){d(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},d(e,t,n,r)}function v(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){v(a,r,o,i,c,"next",e)}function c(e){v(a,r,o,i,c,"throw",e)}i(void 0)})}}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var h="https://story-api.dicoding.dev/v1";const g=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"isAuthenticated",value:function(){return!!localStorage.getItem("token")}},{key:"getCurrentUser",value:function(){return localStorage.getItem("user")}},{key:"register",value:(l=y(p().m(function e(t){var n,r,o,a,i;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=t.name,r=t.email,o=t.password,e.p=1,e.n=2,fetch("".concat(h,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,email:r,password:o})});case 2:return a=e.v,e.n=3,a.json();case 3:if(i=e.v,a.ok){e.n=4;break}return e.a(2,{success:!1,message:i.message});case 4:return e.a(2,{success:!0,message:"Registrasi berhasil"});case 5:return e.p=5,e.v,e.a(2,{success:!1,message:"Koneksi gagal. Coba lagi."})}},e,null,[[1,5]])})),function(e){return l.apply(this,arguments)})},{key:"login",value:(s=y(p().m(function e(t){var n,r,o,a,i,c;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=t.email,r=t.password,e.p=1,e.n=2,fetch("".concat(h,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 2:return o=e.v,e.n=3,o.json();case 3:if(a=e.v,o.ok){e.n=4;break}return e.a(2,{success:!1,message:a.message});case 4:return i=a.loginResult.token,c=a.loginResult.name,localStorage.setItem("token",i),localStorage.setItem("user",c),e.a(2,{success:!0,user:a.loginResult});case 5:return e.p=5,e.v,e.a(2,{success:!1,message:"Terjadi kesalahan koneksi"})}},e,null,[[1,5]])})),function(e){return s.apply(this,arguments)})},{key:"logout",value:function(){localStorage.removeItem("token"),localStorage.removeItem("user")}},{key:"getStories",value:(u=y(p().m(function e(){var t,n,r,o;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=localStorage.getItem("token")){e.n=1;break}return e.a(2,{success:!1,message:"Token tidak ditemukan"});case 1:return e.p=1,e.n=2,fetch("".concat(h,"/stories"),{headers:{Authorization:"Bearer ".concat(t)}});case 2:return n=e.v,e.n=3,n.json();case 3:if(r=e.v,n.ok){e.n=4;break}return e.a(2,{success:!1,message:r.message||"Gagal memuat cerita"});case 4:return e.a(2,{success:!0,list:r.listStory||[]});case 5:return e.p=5,o=e.v,console.error("Error fetching stories:",o),e.a(2,{success:!1,message:"Terjadi kesalahan koneksi"})}},e,null,[[1,5]])})),function(){return u.apply(this,arguments)})},{key:"addStory",value:(c=y(p().m(function e(t){var n,r,o,a,i,c,u,s;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=t.description,r=t.photo,o=t.lat,a=t.lon,i=localStorage.getItem("token")){e.n=1;break}return e.a(2,{success:!1,message:"Token tidak ditemukan"});case 1:return(c=new FormData).append("description",n),r&&c.append("photo",r),o&&c.append("lat",o),a&&c.append("lon",a),e.p=2,e.n=3,fetch("".concat(h,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(i)},body:c});case 3:return u=e.v,e.n=4,u.json();case 4:if(s=e.v,u.ok){e.n=5;break}return e.a(2,{success:!1,message:s.message});case 5:return e.a(2,{success:!0});case 6:return e.p=6,e.v,e.a(2,{success:!1,message:"Gagal menambahkan cerita"})}},e,null,[[2,6]])})),function(e){return c.apply(this,arguments)})},{key:"addStoryFromOffline",value:(i=y(p().m(function e(t){var n,r,o,a,i,c,u,s,l,f;return p().w(function(e){for(;;)switch(e.n){case 0:if(n=t.description,r=t.photoBase64,o=t.lat,a=t.lon,i=localStorage.getItem("token")){e.n=1;break}throw new Error("Token tidak ditemukan");case 1:if((c=new FormData).append("description",n),!r){e.n=4;break}return e.n=2,fetch(r);case 2:return u=e.v,e.n=3,u.blob();case 3:s=e.v,c.append("photo",s,"offline-upload.jpg");case 4:return o&&c.append("lat",o),a&&c.append("lon",a),e.n=5,fetch("".concat(h,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(i)},body:c});case 5:return l=e.v,e.n=6,l.json();case 6:if(f=e.v,l.ok){e.n=7;break}throw new Error(f.message||"Gagal menambahkan cerita dari sync");case 7:return e.a(2,{success:!0})}},e)})),function(e){return i.apply(this,arguments)})},{key:"subscribePushNotification",value:(a=y(p().m(function e(t){var n,r,o,a;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=localStorage.getItem("token")){e.n=1;break}throw new Error("Token tidak ditemukan");case 1:return e.p=1,e.n=2,fetch("".concat(h,"/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(t)});case 2:return r=e.v,e.n=3,r.json();case 3:if(o=e.v,r.ok){e.n=4;break}throw new Error(o.message||"Gagal mendaftarkan notifikasi");case 4:return e.a(2,{success:!0});case 5:throw e.p=5,a=e.v,console.error("‚ùå Gagal mengirim subscription ke API:",a),a;case 6:return e.a(2)}},e,null,[[1,5]])})),function(e){return a.apply(this,arguments)})},{key:"deleteStory",value:(o=y(p().m(function e(t){var n,r,o,a;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=localStorage.getItem("token")){e.n=1;break}return e.a(2,{success:!1,message:"Token tidak ditemukan"});case 1:return e.p=1,e.n=2,fetch("".concat(h,"/stories/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(n)}});case 2:return r=e.v,e.n=3,r.json();case 3:if(o=e.v,r.ok){e.n=4;break}return e.a(2,{success:!1,message:o.message||"Gagal menghapus cerita."});case 4:return e.a(2,{success:!0,message:o.message});case 5:return e.p=5,a=e.v,console.error("Error saat menghapus cerita:",a),e.a(2,{success:!1,message:"Gagal menghubungi server. Coba lagi."})}},e,null,[[1,5]])})),function(e){return o.apply(this,arguments)})},{key:"addFavorite",value:(r=y(p().m(function e(t){var n;return p().w(function(e){for(;;)switch(e.n){case 0:(n=JSON.parse(localStorage.getItem("favorites")||"[]")).includes(t)||n.push(t),localStorage.setItem("favorites",JSON.stringify(n));case 1:return e.a(2)}},e)})),function(e){return r.apply(this,arguments)})},{key:"removeFavorite",value:(n=y(p().m(function e(t){var n;return p().w(function(e){for(;;)switch(e.n){case 0:n=(n=JSON.parse(localStorage.getItem("favorites")||"[]")).filter(function(e){return e!==t}),localStorage.setItem("favorites",JSON.stringify(n));case 1:return e.a(2)}},e)})),function(e){return n.apply(this,arguments)})},{key:"getAllFavorites",value:function(){return JSON.parse(localStorage.getItem("favorites")||"[]")}}],t&&m(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,a,i,c,u,s,l}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function S(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}const j=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},(t=[{key:"render",value:function(){var e=document.querySelector("main");if(e){e.innerHTML='\n      <section class="auth-section fade-in" aria-labelledby="login-heading">\n        <h2 id="login-heading">Masuk ke CeritaKu</h2>\n        <form id="login-form" class="auth-form" aria-describedby="login-desc">\n          <p id="login-desc" class="visually-hidden">Masukkan email dan kata sandi Anda untuk masuk ke aplikasi CeritaKu</p>\n          \n          <label for="email" class="visually-hidden">Email</label>\n          <input \n            type="email" \n            id="email" \n            placeholder="Email" \n            required \n            autocomplete="username"\n            aria-label="Masukkan email Anda"\n          />\n\n          <label for="password" class="visually-hidden">Kata Sandi</label>\n          <input \n            type="password" \n            id="password" \n            placeholder="Password" \n            required \n            autocomplete="current-password"\n            aria-label="Masukkan kata sandi Anda"\n          />\n\n          <button type="submit" class="btn-primary">Masuk</button>\n        </form>\n        <p>Belum punya akun? <a href="#/register">Daftar</a></p>\n        <div id="login-message" class="visually-hidden" aria-live="polite"></div>\n      </section>\n    ';var t=e.querySelector("#email");t&&t.focus()}}}])&&k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}function E(e){var t=function(e){if("object"!=P(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==P(t)?t:t+""}const T=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},(t=[{key:"render",value:function(){var e=document.querySelector("main");if(e){e.innerHTML='\n      <section class="auth-section fade-in" aria-labelledby="register-heading">\n        <h2 id="register-heading">Daftar Akun CeritaKu</h2>\n        <form id="register-form" class="auth-form" aria-describedby="register-desc">\n          <p id="register-desc" class="visually-hidden">\n            Lengkapi nama, email, dan password untuk membuat akun CeritaKu.\n          </p>\n\n          <label for="name" class="visually-hidden">Nama Lengkap</label>\n          <input type="text" id="name" placeholder="Nama Lengkap" required aria-label="Nama Lengkap" />\n\n          <label for="email" class="visually-hidden">Email</label>\n          <input type="email" id="email" placeholder="Email" required aria-label="Email" />\n\n          <label for="password" class="visually-hidden">Password</label>\n          <input type="password" id="password" placeholder="Password" required aria-label="Password" />\n\n          <button type="submit" class="btn-primary">Daftar</button>\n        </form>\n        <p>Sudah punya akun? <a href="#/login">Masuk</a></p>\n      </section>\n    ';var t=e.querySelector("#name");t&&t.focus()}}}])&&O(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("toast-container"),r=document.createElement("div");r.className="toast ".concat(t),r.textContent=e,n.appendChild(r),setTimeout(function(){return r.remove()},3e3)}var I=function(e){var t,n,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).isFavoritePage||!1,o=e.photoUrl||(e.photoBase64?e.photoBase64:"default-image.jpg");return'\n      <div class="story-item fade-in" id="story-'.concat(e.id,'">\n        <div class="story-header">\n          <h3 class="story-title">').concat(e.description.substring(0,50),'...</h3>\n          <p class="story-date">').concat(new Date(e.createdAt||Date.now()).toLocaleDateString(),'</p>\n        </div>\n        <div class="story-image-container">\n          <img class="story-image" \n               src="').concat(o,'" \n               alt="Gambar cerita yang diunggah" \n               loading="lazy">\n        </div>\n        \n        <div class="story-footer">\n          ').concat((t="number"==typeof e.lat?e.lat:e.lat?Number(e.lat):null,n="number"==typeof e.lon?e.lon:e.lon?Number(e.lon):null,null==t||null==n||isNaN(t)||isNaN(n)?'<p class="story-location">Lokasi Tidak Tersedia</p>':'<p class="story-location">üìç Lat: '.concat(t.toFixed(6),", Lon: ").concat(n.toFixed(6),"</p>")),'\n          \n          <div class="story-actions">\n            \n            ').concat(r?'\n                <button \n                  class="delete-favorite-button button secondary" \n                  data-id="'.concat(e.id,'" \n                  aria-label="Hapus cerita dari daftar favorite">\n                  üóëÔ∏è Hapus dari Favorite\n                </button>\n              '):'\n                <button \n                  class="add-favorite-button button primary" \n                  data-id="'.concat(e.id,'" \n                  aria-label="Simpan cerita ke favorite">\n                  üíñ Simpan ke Favorite\n                </button>\n              '),'\n            \n            <a href="#/stories/').concat(e.id,'" class="button tertiary">Lihat Detail</a>\n          </div>\n        </div>\n      </div>\n    ')};function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,G(r.key),r)}}function G(e){var t=function(e){if("object"!=B(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==B(t)?t:t+""}function x(e){return e?String(e).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):""}const D=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"render",value:function(){var e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e){document.querySelector("main").innerHTML='\n      <section class="hero" role="region" aria-labelledby="hero-heading">\n        <h2 id="hero-heading">Ceritaku</h2>\n        <p>Berbagi cerita pengguna dengan lokasi</p>\n      </section>\n\n      <div class="main-content" role="main">\n        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;flex-wrap:wrap;gap:12px">\n          <div>\n            <label for="filterSelect">Filter:</label>\n            <select id="filterSelect" aria-label="Filter cerita berdasarkan lokasi">\n              <option value="all">Semua</option>\n              <option value="with-location">Dengan Lokasi</option>\n              <option value="without-location">Tanpa Lokasi</option>\n            </select>\n          </div>\n          <div style="display:flex;gap:8px;flex-wrap:wrap">\n            <button class="btn" id="push-subscribe-btn" aria-label="Berlangganan notifikasi cerita baru" style="display:none;">\n              üîî Berlangganan Notifikasi\n            </button>\n            <button class="btn" id="push-unsubscribe-btn" aria-label="Berhenti berlangganan notifikasi" style="display:none;">\n              üîï Berhenti Berlangganan\n            </button>\n            <button class="btn" id="add-btn" aria-label="Tambah cerita baru">Tambah Cerita</button>\n          </div>\n        </div>\n\n        <div id="map" class="map-wrapper" style="height:300px;" role="region" aria-label="Peta lokasi cerita"></div>\n\n        <section class="story-list" id="story-container" aria-live="polite" aria-label="Daftar cerita pengguna"></section>\n      </div>\n    ',this.renderNavigation(t),document.getElementById("filterSelect").addEventListener("change",function(e){var t=new CustomEvent("filter:change",{detail:{value:e.target.value}});document.dispatchEvent(t)});var n=document.getElementById("story-container");n&&n.setAttribute("tabindex","-1")}else l.navigate("/login")}},{key:"renderNavigation",value:function(e){var t=document.getElementById("nav-menu");if(t){t.setAttribute("role","navigation"),t.setAttribute("aria-label","Navigasi utama"),t.innerHTML='\n      <a href="#/home" aria-current="page">Beranda</a>\n      <a href="#/add">Tambah Cerita</a>\n      <a href="#/favorites">üíñ Cerita Tersimpan</a>\n      <span style="margin-left:auto;color:#555;">'.concat(e?"Halo, ".concat(x(e)):"",'</span>\n      <a href="#/login" id="logout-link" style="color:red;">Logout</a>\n    ');var n=document.getElementById("logout-link");n&&n.addEventListener("click",function(e){e.preventDefault(),localStorage.removeItem("token"),localStorage.removeItem("user"),_("Berhasil logout!","success"),l.navigate("/login")})}}},{key:"bindCardClick",value:function(e){var t=document.getElementById("story-container");t&&t.addEventListener("click",function(t){var n=t.target.closest(".story-card");if(n){var r=n.dataset.id;e(r)}})}},{key:"bindFavoriteClick",value:function(e,t){var n=document.getElementById("story-container");n&&n.addEventListener("click",function(n){var r=n.target.closest(".add-favorite-button"),o=n.target.closest(".delete-favorite-button");if(r){var a=r.dataset.id;e(a)}if(o){var i=o.dataset.id;t(i)}})}},{key:"renderStories",value:function(e){var t=document.getElementById("story-container");t&&(e&&0!==e.length?t.innerHTML=e.map(function(e){return I(e)}).join(""):t.innerHTML='<p role="status">Tidak ada cerita</p>')}},{key:"initMap",value:function(e){window.L?(this._map&&(this._map.remove(),this._map=null),this._map=L.map("map").setView([-2.5489,118.0149],5),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(this._map),this._markers=[],this.updateMap(e)):console.warn("Leaflet not loaded.")}},{key:"updateMap",value:function(e){var t=this;if(this._map){this._markers&&this._markers.length&&this._markers.forEach(function(e){return t._map.removeLayer(e)}),this._markers=[];var n=[];if(e.forEach(function(e){var r,o,a=null!==(r=e.lat)&&void 0!==r?r:null,i=null!==(o=e.lon)&&void 0!==o?o:null;if(null!=a&&null!=i&&!Number.isNaN(a)&&!Number.isNaN(i)){var c=L.marker([a,i]).addTo(t._map);c.bindPopup("<b>".concat(x(e.name||""),"</b><p>").concat(x(e.description||""),"</p>")),t._markers.push(c),n.push([a,i])}}),n.length){var r=L.latLngBounds(n);this._map.fitBounds(r.pad(.2))}}}}],t&&C(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function M(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return N(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(N(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,N(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,N(f,"constructor",s),N(s,"constructor",u),u.displayName="GeneratorFunction",N(s,o,"GeneratorFunction"),N(f),N(f,o,"Generator"),N(f,r,function(){return this}),N(f,"toString",function(){return"[object Generator]"}),(M=function(){return{w:a,m:p}})()}function N(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}N=function(e,t,n,r){function a(t,n){N(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},N(e,t,n,r)}function A(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function q(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){A(a,r,o,i,c,"next",e)}function c(e){A(a,r,o,i,c,"throw",e)}i(void 0)})}}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,R(r.key),r)}}function R(e){var t=function(e){if("object"!=F(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==F(t)?t:t+""}const V=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stream=null,this.hashListener=null},t=[{key:"render",value:function(){var e=this,t=document.querySelector("main");if(t){t.innerHTML='\n      <section class="add-story-section fade-in" aria-labelledby="add-story-heading">\n        <h2 id="add-story-heading">Tambah Cerita Baru</h2>\n        <form id="add-story-form" aria-describedby="add-story-desc">\n          <p id="add-story-desc" class="visually-hidden">Isi judul, deskripsi, tambahkan foto, dan pilih lokasi pada peta.</p>\n          \n          <label for="title" class="visually-hidden">Judul Cerita</label>\n          <input type="text" id="title" placeholder="Judul Cerita" required aria-label="Judul cerita" />\n\n          <label for="description" class="visually-hidden">Deskripsi Cerita</label>\n          <textarea id="description" placeholder="Deskripsi Cerita" required aria-label="Deskripsi cerita"></textarea>\n\n          <div class="photo-section">\n            <h3>Foto Cerita</h3>\n            <div class="photo-choice">\n              <button type="button" id="use-camera-btn" class="btn" aria-label="Gunakan kamera">Gunakan Kamera</button>\n              <input type="file" id="upload-file" accept="image/*" style="display:none" aria-label="Unggah foto dari galeri" />\n              <button type="button" id="upload-btn" class="btn" aria-label="Unggah foto dari file">Upload file</button>\n            </div>\n\n            <div class="camera-section" style="display:none;">\n              <video id="camera" autoplay playsinline></video>\n              <button type="button" id="capture-btn" class="btn">Ambil Foto</button>\n              <canvas id="preview" style="display:none;"></canvas>\n            </div>\n          </div>\n\n          <div class="map-section">\n            <h3>Pilih Lokasi</h3>\n            <div id="map" style="height: 250px; border-radius: 10px; margin-top: 10px;"></div>\n          </div>\n\n          <button type="submit" class="btn-primary">Simpan Cerita</button>\n        </form>\n      </section>\n    ';var n=t.querySelector("#title");n&&n.focus(),this.bindPhotoOptions(),this.initMap(),this.hashListener&&window.removeEventListener("hashchange",this.hashListener),this.hashListener=function(){location.hash.includes("/add")||e.stopCamera()},window.addEventListener("hashchange",this.hashListener)}}},{key:"bindPhotoOptions",value:function(){var e=this,t=document.getElementById("use-camera-btn"),n=document.getElementById("upload-btn"),r=document.getElementById("upload-file"),o=document.querySelector(".camera-section");t&&t.addEventListener("click",q(M().m(function t(){return M().w(function(t){for(;;)switch(t.n){case 0:return o.style.display="block",t.n=1,e.initCamera();case 1:return t.a(2)}},t)}))),n&&n.addEventListener("click",function(){return r.click()}),r&&r.addEventListener("change",function(t){var n=t.target.files[0];if(n){var r=new FileReader;r.onload=function(){localStorage.setItem("lastCapturedPhoto",r.result),e.stopCamera(),alert("üì∏ Foto dari galeri berhasil diunggah!")},r.readAsDataURL(n)}})}},{key:"initCamera",value:(r=q(M().m(function e(){var t,n,r,o=this;return M().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("camera")){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,navigator.mediaDevices.getUserMedia({video:!0});case 2:this.stream=e.v,t.srcObject=this.stream,(n=document.getElementById("capture-btn"))&&(n.onclick=function(){return o.capturePhoto()}),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Gagal mengakses kamera:",r),alert("Tidak dapat mengakses kamera. Pastikan izin kamera telah diberikan.");case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return r.apply(this,arguments)})},{key:"capturePhoto",value:function(){var e=document.getElementById("camera"),t=document.getElementById("preview");if(e&&t){var n=t.getContext("2d");t.width=e.videoWidth,t.height=e.videoHeight,n.drawImage(e,0,0,t.width,t.height),t.style.display="block";var r=t.toDataURL("image/png");localStorage.setItem("lastCapturedPhoto",r),this.stopCamera(),alert("üì∑ Foto berhasil diambil dan kamera dimatikan.")}}},{key:"stopCamera",value:function(){this.stream&&(this.stream.getTracks().forEach(function(e){return e.stop()}),this.stream=null,console.log("üì∑ Kamera dimatikan otomatis."))}},{key:"initMap",value:(n=q(M().m(function e(){var t,n;return M().w(function(e){for(;;)switch(e.n){case 0:if("undefined"!=typeof L){e.n=1;break}return console.error("Leaflet belum dimuat."),e.a(2);case 1:t=L.map("map").setView([-5.1477,119.4327],13),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(t),t.on("click",function(e){var r=e.latlng,o=r.lat,a=r.lng;n&&t.removeLayer(n),n=L.marker([o,a]).addTo(t),localStorage.setItem("selectedLocation",JSON.stringify({lat:o,lng:a}))});case 2:return e.a(2)}},e)})),function(){return n.apply(this,arguments)})}],t&&H(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,J(r.key),r)}}function J(e){var t=function(e){if("object"!=K(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(t)?t:t+""}const W=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},(t=[{key:"render",value:function(){document.querySelector("main").innerHTML='\n        <section class="not-found">\n          <h1>404 - Halaman Tidak Ditemukan</h1>\n          <p>Maaf, halaman yang kamu cari tidak tersedia.</p>\n          <button class="btn-primary" id="back-home">Kembali ke Beranda</button>\n        </section>\n      ',document.getElementById("back-home").addEventListener("click",function(){window.location.hash="/home"})}}])&&U(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y(r.key),r)}}function Y(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}const $=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._mainContent=document.getElementById("main-content")},t=[{key:"render",value:function(){var e=localStorage.getItem("user");this._mainContent.innerHTML='\n      <section class="content">\n        <div class="container">\n          <h2 class="content-title" tabindex="0">Cerita Tersimpan (Favorite)</h2>\n          <p class="content-subtitle">Lihat cerita yang Anda simpan secara lokal.</p>\n          <div id="favorite-list" class="story-list grid">\n            </div>\n          <div id="favorite-empty-message" class="empty-state" style="display: none;">\n            </div>\n        </div>\n      </section>\n    ',this._favoriteListContainer=document.getElementById("favorite-list"),this._emptyMessageContainer=document.getElementById("favorite-empty-message"),this.renderNavigation(e)}},{key:"renderNavigation",value:function(e){var t=document.getElementById("nav-menu");if(t){t.setAttribute("role","navigation"),t.setAttribute("aria-label","Navigasi utama"),t.innerHTML='\n      <a href="#/home">Beranda</a>\n      <a href="#/add">Tambah Cerita</a>\n      <a href="#/favorites" aria-current="page">üíñ Cerita Tersimpan</a>\n      <span style="margin-left:auto;color:#555;">'.concat(e?"Halo, ".concat(e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")):"",'</span>\n      <a href="#/login" id="logout-link" style="color:red;">Logout</a>\n    ');var n=document.getElementById("logout-link");n&&n.addEventListener("click",function(e){e.preventDefault(),localStorage.removeItem("token"),localStorage.removeItem("user"),_("Berhasil logout!","success"),l.navigate("/login")})}}},{key:"displayStories",value:function(e){var t=this;this._emptyMessageContainer.style.display="none",this._favoriteListContainer.innerHTML="",e.forEach(function(e){var n=I(e,{isFavoritePage:!0});t._favoriteListContainer.innerHTML+=n})}},{key:"showEmptyMessage",value:function(e){this._favoriteListContainer.innerHTML="",this._emptyMessageContainer.style.display="block",this._emptyMessageContainer.innerHTML='\n      <p aria-live="polite">'.concat(e,'</p>\n      <a href="#/home" class="button primary">Lihat Semua Cerita</a>\n    ')}},{key:"bindDeleteFavorite",value:function(e){this._favoriteListContainer.addEventListener("click",function(t){var n=t.target.closest(".delete-favorite-button");if(n){t.preventDefault();var r=n.dataset.id;confirm("Apakah Anda yakin ingin menghapus cerita dari favorite?")&&e(r)}})}},{key:"showLoading",value:function(){document.getElementById("loading-spinner").style.display="flex"}},{key:"hideLoading",value:function(){document.getElementById("loading-spinner").style.display="none"}},{key:"showErrorMessage",value:function(e){this._favoriteListContainer.innerHTML='<p class="error-message">'.concat(e,"</p>")}}],t&&Q(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function Z(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ee(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ee(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ee(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ee(f,"constructor",s),ee(s,"constructor",u),u.displayName="GeneratorFunction",ee(s,o,"GeneratorFunction"),ee(f),ee(f,o,"Generator"),ee(f,r,function(){return this}),ee(f,"toString",function(){return"[object Generator]"}),(Z=function(){return{w:a,m:p}})()}function ee(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ee=function(e,t,n,r){function a(t,n){ee(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},ee(e,t,n,r)}function te(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ne(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){te(a,r,o,i,c,"next",e)}function c(e){te(a,r,o,i,c,"throw",e)}i(void 0)})}}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oe(r.key),r)}}function oe(e){var t=function(e){if("object"!=X(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X(t)?t:t+""}const ae=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=t},t=[{key:"init",value:(n=ne(Z().m(function e(){return Z().w(function(e){for(;;)switch(e.n){case 0:this.view.render(),document.getElementById("login-form").addEventListener("submit",function(){var e=ne(Z().m(function e(t){var n,r,o;return Z().w(function(e){for(;;)switch(e.n){case 0:return t.preventDefault(),n=document.getElementById("email").value.trim(),r=document.getElementById("password").value.trim(),e.n=1,g.login({email:n,password:r});case 1:(o=e.v).success?(_("Login berhasil!","success"),l.navigate("/home")):_(o.message,"error");case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})}],t&&re(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ce(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ue(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ue(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ue(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ue(f,"constructor",s),ue(s,"constructor",u),u.displayName="GeneratorFunction",ue(s,o,"GeneratorFunction"),ue(f),ue(f,o,"Generator"),ue(f,r,function(){return this}),ue(f,"toString",function(){return"[object Generator]"}),(ce=function(){return{w:a,m:p}})()}function ue(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ue=function(e,t,n,r){function a(t,n){ue(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},ue(e,t,n,r)}function se(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fe(r.key),r)}}function fe(e){var t=function(e){if("object"!=ie(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ie(t)?t:t+""}const pe=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=t},t=[{key:"init",value:(n=ce().m(function e(){return ce().w(function(e){for(;;)switch(e.n){case 0:this.view.render(),document.getElementById("register-form").addEventListener("submit",function(e){e.preventDefault();var t=document.getElementById("name").value.trim(),n=document.getElementById("email").value.trim(),r=document.getElementById("password").value.trim(),o=g.register({name:t,email:n,password:r});o.success?(_("Registrasi berhasil! Silakan login.","success"),l.navigate("/login")):_(o.message,"error")});case 1:return e.a(2)}},e,this)}),r=function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function i(e){se(a,r,o,i,c,"next",e)}function c(e){se(a,r,o,i,c,"throw",e)}i(void 0)})},function(){return r.apply(this,arguments)})}],t&&le(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();var de=n(602);function ve(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ye(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ye(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ye(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ye(f,"constructor",s),ye(s,"constructor",u),u.displayName="GeneratorFunction",ye(s,o,"GeneratorFunction"),ye(f),ye(f,o,"Generator"),ye(f,r,function(){return this}),ye(f,"toString",function(){return"[object Generator]"}),(ve=function(){return{w:a,m:p}})()}function ye(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ye=function(e,t,n,r){function a(t,n){ye(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},ye(e,t,n,r)}function me(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function be(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){me(a,r,o,i,c,"next",e)}function c(e){me(a,r,o,i,c,"throw",e)}i(void 0)})}}var he="sync-stories",ge="favorite-stories",we="tokens",ke=(0,de.openDB)("CeritaKuDB",1,{upgrade:function(e){e.objectStoreNames.contains(he)||e.createObjectStore(he,{keyPath:"id"}),e.objectStoreNames.contains(ge)||e.createObjectStore(ge,{keyPath:"id"}),e.objectStoreNames.contains(we)||e.createObjectStore(we,{keyPath:"key"})}});const Se=function(e){return be(ve().m(function t(){var n,r;return ve().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ke;case 1:return n=t.v,r=n.transaction(he,"readwrite"),t.n=2,r.store.put(e);case 2:return t.n=3,r.done;case 3:return t.a(2)}},t)}))()},je=function(e){return be(ve().m(function t(){var n;return ve().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ke;case 1:return n=t.v,t.n=2,n.put(ge,e);case 2:return t.a(2)}},t)}))()},Pe=function(){return be(ve().m(function e(){var t;return ve().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ke;case 1:return t=e.v,e.a(2,t.getAll(ge))}},e)}))()},Oe=function(e){return be(ve().m(function t(){var n;return ve().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ke;case 1:return n=t.v,t.n=2,n.delete(ge,e);case 2:return t.a(2)}},t)}))()};function Ee(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Te(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Te(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Te(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Te(f,"constructor",s),Te(s,"constructor",u),u.displayName="GeneratorFunction",Te(s,o,"GeneratorFunction"),Te(f),Te(f,o,"Generator"),Te(f,r,function(){return this}),Te(f,"toString",function(){return"[object Generator]"}),(Ee=function(){return{w:a,m:p}})()}function Te(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Te=function(e,t,n,r){function a(t,n){Te(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Te(e,t,n,r)}function Le(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function _e(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Le(a,r,o,i,c,"next",e)}function c(e){Le(a,r,o,i,c,"throw",e)}i(void 0)})}}function Ie(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}var Be={isSupported:function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window},isSubscribed:function(){var e=this;return _e(Ee().m(function t(){var n,r,o;return Ee().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.isSupported()){t.n=1;break}return t.a(2,!1);case 1:return t.p=1,t.n=2,navigator.serviceWorker.ready;case 2:return n=t.v,t.n=3,n.pushManager.getSubscription();case 3:return r=t.v,t.a(2,Boolean(r));case 4:return t.p=4,o=t.v,console.error("Error checking subscription status:",o),t.a(2,!1)}},t,null,[[1,4]])}))()},subscribe:function(){var e=this;return _e(Ee().m(function t(){var n,r,o,a,i;return Ee().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.isSupported()){t.n=1;break}throw new Error("Push notification tidak didukung di browser ini");case 1:return t.p=1,t.n=2,navigator.serviceWorker.ready;case 2:return n=t.v,t.n=3,n.pushManager.getSubscription();case 3:if(!(r=t.v)){t.n=4;break}return t.a(2,r);case 4:return t.n=5,Notification.requestPermission();case 5:if("granted"===t.v){t.n=6;break}throw new Error("Izin notifikasi ditolak");case 6:return o=Ie("BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk"),t.n=7,n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o});case 7:return r=t.v,delete(a=r.toJSON()).expirationTime,t.n=8,g.subscribePushNotification(a);case 8:return t.a(2,r);case 9:throw t.p=9,i=t.v,console.error("‚ùå Gagal subscribe push notification:",i),i;case 10:return t.a(2)}},t,null,[[1,9]])}))()},unsubscribe:function(){var e=this;return _e(Ee().m(function t(){var n,r,o;return Ee().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.isSupported()){t.n=1;break}throw new Error("Push notification tidak didukung di browser ini");case 1:return t.p=1,t.n=2,navigator.serviceWorker.ready;case 2:return n=t.v,t.n=3,n.pushManager.getSubscription();case 3:if(!(r=t.v)){t.n=5;break}return t.n=4,r.unsubscribe();case 4:return t.a(2,!0);case 5:return t.a(2,!1);case 6:throw t.p=6,o=t.v,console.error("‚ùå Gagal unsubscribe push notification:",o),o;case 7:return t.a(2)}},t,null,[[1,6]])}))()}};function Ce(e){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ce(e)}function Ge(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return xe(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(xe(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,xe(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,xe(f,"constructor",s),xe(s,"constructor",u),u.displayName="GeneratorFunction",xe(s,o,"GeneratorFunction"),xe(f),xe(f,o,"Generator"),xe(f,r,function(){return this}),xe(f,"toString",function(){return"[object Generator]"}),(Ge=function(){return{w:a,m:p}})()}function xe(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}xe=function(e,t,n,r){function a(t,n){xe(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},xe(e,t,n,r)}function De(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Fe(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){De(a,r,o,i,c,"next",e)}function c(e){De(a,r,o,i,c,"throw",e)}i(void 0)})}}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ne(r.key),r)}}function Ne(e){var t=function(e){if("object"!=Ce(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ce(t)?t:t+""}const Ae=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=new D},t=[{key:"init",value:(r=Fe(Ge().m(function e(){var t,n,r,o;return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:return(t=document.querySelector("#main-content"))&&(t.style.opacity="0"),this.view.render(),e.n=1,g.getStories();case 1:if((n=e.v)&&n.success){e.n=2;break}return _((null==n?void 0:n.message)||"Gagal memuat cerita","error"),this.view.renderStories([]),this.view.initMap([]),this._bindUI(),this._afterRenderAccessibility(),e.a(2,{view:this.view});case 2:return r=(n.list||[]).map(function(e){var t,n,r,o,a,i,c,u,s,l,f,p,d=null!==(t=null!==(n=null!==(r=e.lat)&&void 0!==r?r:null===(o=e.location)||void 0===o?void 0:o.lat)&&void 0!==n?n:null===(a=e.location)||void 0===a?void 0:a.latitude)&&void 0!==t?t:null,v=null!==(i=null!==(c=null!==(u=null!==(s=e.lon)&&void 0!==s?s:null===(l=e.location)||void 0===l?void 0:l.lon)&&void 0!==u?u:null===(f=e.location)||void 0===f?void 0:f.longitude)&&void 0!==c?c:null===(p=e.location)||void 0===p?void 0:p.lng)&&void 0!==i?i:null;return{id:e.id||e._id||e.storyId||"",name:e.name||e.title||"",description:e.description||e.story||"",photoUrl:e.photoUrl||e.photo||e.image||"",lat:d?Number(d):null,lon:v?Number(v):null,createdAt:e.createdAt||e.created_at||e.created||""}}),this.view.renderStories(r),this.view.initMap(r),this._bindUI(r),e.p=3,e.n=4,this._setupPushNotifications();case 4:e.n=6;break;case 5:e.p=5,o=e.v,console.warn("Push notification setup error:",o);case 6:return this._afterRenderAccessibility(),t&&setTimeout(function(){t.style.transition="opacity 0.3s ease-in-out",t.style.opacity="1"},100),e.a(2,{view:this.view})}},e,this,[[3,5]])})),function(){return r.apply(this,arguments)})},{key:"_bindUI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=document.getElementById("add-btn");t&&t.addEventListener("click",function(){return l.navigate("/add")}),this.view.bindCardClick(function(e){console.log("Kartu dengan ID:",e)}),this.view.bindFavoriteClick(function(){var t=Fe(Ge().m(function t(n){var r,o;return Ge().w(function(t){for(;;)switch(t.p=t.n){case 0:if(r=e.find(function(e){return e.id===n})){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,je(r);case 2:_("Cerita berhasil disimpan ke favorite!","success"),t.n=4;break;case 3:t.p=3,o=t.v,console.error("‚ùå Gagal menyimpan cerita ke favorite:",o),_("Gagal menyimpan cerita ke favorite.","error");case 4:return t.a(2)}},t,null,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),null)}},{key:"_setupPushNotifications",value:(n=Fe(Ge().m(function e(){var t,n,r,o=this;return Ge().w(function(e){for(;;)switch(e.n){case 0:if(t=document.getElementById("push-subscribe-btn"),n=document.getElementById("push-unsubscribe-btn"),t&&n){e.n=1;break}return e.a(2);case 1:if(t.style.display="none",n.style.display="none",Be.isSupported()){e.n=2;break}return e.a(2);case 2:return e.n=3,Be.isSubscribed();case 3:r=e.v,this._updatePushButtonState(r),t.addEventListener("click",Fe(Ge().m(function e(){return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t.disabled=!0,t.textContent="Memproses...",e.n=1,Be.subscribe();case 1:o._updatePushButtonState(!0),_("Berhasil berlangganan notifikasi!","success"),e.n=3;break;case 2:e.p=2,_(e.v.message||"Gagal berlangganan notifikasi","error");case 3:return e.p=3,t.disabled=!1,t.textContent="üîî Berlangganan Notifikasi",e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}))),n.addEventListener("click",Fe(Ge().m(function e(){return Ge().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n.disabled=!0,n.textContent="Memproses...",e.n=1,Be.unsubscribe();case 1:o._updatePushButtonState(!1),_("Berhasil berhenti berlangganan notifikasi","success"),e.n=3;break;case 2:e.p=2,_(e.v.message||"Gagal berhenti berlangganan","error");case 3:return e.p=3,n.disabled=!1,n.textContent="üîï Berhenti Berlangganan",e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])})));case 4:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"_updatePushButtonState",value:function(e){var t=document.getElementById("push-subscribe-btn"),n=document.getElementById("push-unsubscribe-btn");t&&n&&(t.style.display=e?"none":"inline-block",n.style.display=e?"inline-block":"none")}},{key:"_afterRenderAccessibility",value:function(){var e=document.querySelector("#main-content");e&&(e.setAttribute("tabindex","-1"),e.focus({preventScroll:!1}),e.setAttribute("aria-live","polite"),e.setAttribute("role","main"))}}],t&&Me(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function He(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Re(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Re(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Re(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Re(f,"constructor",s),Re(s,"constructor",u),u.displayName="GeneratorFunction",Re(s,o,"GeneratorFunction"),Re(f),Re(f,o,"Generator"),Re(f,r,function(){return this}),Re(f,"toString",function(){return"[object Generator]"}),(He=function(){return{w:a,m:p}})()}function Re(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Re=function(e,t,n,r){function a(t,n){Re(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Re(e,t,n,r)}function Ve(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ke(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){Ve(a,r,o,i,c,"next",e)}function c(e){Ve(a,r,o,i,c,"throw",e)}i(void 0)})}}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Je(r.key),r)}}function Je(e){var t=function(e){if("object"!=qe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qe(t)?t:t+""}const We=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=t},t=[{key:"init",value:(r=Ke(He().m(function e(){return He().w(function(e){for(;;)switch(e.n){case 0:this.view.render(),this._bindUI();case 1:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"_bindUI",value:function(){var e=this,t=document.getElementById("add-story-form");t&&t.addEventListener("submit",function(){var n=Ke(He().m(function n(r){var o,a,i,c,u,s,f,p,d,v,y,m,b,h,w,k;return He().w(function(n){for(;;)switch(n.p=n.n){case 0:if(r.preventDefault(),o=t.querySelector("#description").value.trim(),a=null,i=localStorage.getItem("lastCapturedPhoto"),c=t.querySelector("#upload-file"),!i){n.n=3;break}return n.n=1,fetch(i);case 1:return u=n.v,n.n=2,u.blob();case 2:a=n.v,n.n=4;break;case 3:c&&c.files[0]&&(a=c.files[0]);case 4:if(s=null,f=null,p=localStorage.getItem("selectedLocation"))try{d=JSON.parse(p),s=d.lat,f=d.lng||d.lon}catch(e){console.error("Error parsing location:",e)}if(o){n.n=5;break}return _("Deskripsi tidak boleh kosong","error"),n.a(2);case 5:if(v=t.querySelector('button[type="submit"]'),y=v?v.textContent:"",v&&(v.disabled=!0,v.textContent="Menyimpan..."),n.p=6,!navigator.onLine){n.n=9;break}return n.n=7,g.addStory({description:o,photo:a,lat:s,lon:f});case 7:if((m=n.v).success){n.n=8;break}throw new Error(m.message);case 8:_("Cerita berhasil ditambahkan!","success"),n.n=15;break;case 9:if(h=i){n.n=13;break}if(!a){n.n=11;break}return n.n=10,e._convertFileToBase64(a);case 10:w=n.v,n.n=12;break;case 11:w=null;case 12:h=w;case 13:return b=h,n.n=14,Se({id:"offline-".concat(Date.now()),description:o,photoBase64:b,lat:s,lon:f,createdAt:Date.now()});case 14:_("Sedang offline. Cerita disimpan sementara untuk disinkronkan nanti.","info");case 15:localStorage.removeItem("lastCapturedPhoto"),localStorage.removeItem("selectedLocation"),t.reset(),l.navigate("/home"),n.n=17;break;case 16:n.p=16,k=n.v,console.error("‚ùå Gagal menambahkan cerita:",k),_(k.message||"Gagal menambahkan cerita","error");case 17:return n.p=17,v&&(v.disabled=!1,v.textContent=y),n.f(17);case 18:return n.a(2)}},n,null,[[6,16,17,18]])}));return function(e){return n.apply(this,arguments)}}())}},{key:"_convertFileToBase64",value:(n=Ke(He().m(function e(t){return He().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){return e(r.result)},r.onerror=function(e){return n(e)}}))},e)})),function(e){return n.apply(this,arguments)})}],t&&Ue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function ze(e){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ze(e)}function Qe(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Ye(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Ye(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ye(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Ye(f,"constructor",s),Ye(s,"constructor",u),u.displayName="GeneratorFunction",Ye(s,o,"GeneratorFunction"),Ye(f),Ye(f,o,"Generator"),Ye(f,r,function(){return this}),Ye(f,"toString",function(){return"[object Generator]"}),(Qe=function(){return{w:a,m:p}})()}function Ye(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ye=function(e,t,n,r){function a(t,n){Ye(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Ye(e,t,n,r)}function $e(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Xe(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){$e(a,r,o,i,c,"next",e)}function c(e){$e(a,r,o,i,c,"throw",e)}i(void 0)})}}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,et(r.key),r)}}function et(e){var t=function(e){if("object"!=ze(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ze(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ze(t)?t:t+""}const tt=function(){return e=function e(t){var n,r,o,a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r="handleDeleteFavorite",o=function(){var e=Xe(Qe().m(function e(t){var n;return Qe().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,Oe(t);case 2:return _("Cerita berhasil dihapus dari daftar favorite!","success"),e.n=3,a.loadFavoriteStories();case 3:e.n=5;break;case 4:e.p=4,n=e.v,console.error("‚ùå Gagal menghapus cerita dari IndexedDB:",n),_("Gagal menghapus cerita favorite.","error");case 5:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}(),(r=et(r))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this.view=t},t=[{key:"init",value:(r=Xe(Qe().m(function e(){return Qe().w(function(e){for(;;)switch(e.n){case 0:return this.view.render(),e.n=1,this.loadFavoriteStories();case 1:this.view.bindDeleteFavorite(this.handleDeleteFavorite);case 2:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"loadFavoriteStories",value:(n=Xe(Qe().m(function e(){var t,n;return Qe().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.view.showLoading(),e.p=1,e.n=2,Pe();case 2:(t=e.v)&&0!==t.length?this.view.displayStories(t,{isFavoritePage:!0}):this.view.showEmptyMessage("Anda belum menyimpan cerita favorite."),e.n=4;break;case 3:e.p=3,n=e.v,console.error("‚ùå Gagal memuat cerita tersimpan dari IndexedDB:",n),this.view.showErrorMessage("Gagal memuat cerita tersimpan. Cek konsol untuk detail.");case 4:return e.p=4,this.view.hideLoading(),e.f(4);case 5:return e.a(2)}},e,this,[[1,3,4,5]])})),function(){return n.apply(this,arguments)})}],t&&Ze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function nt(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return rt(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(rt(t={},r,function(){return this}),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,rt(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,rt(f,"constructor",s),rt(s,"constructor",u),u.displayName="GeneratorFunction",rt(s,o,"GeneratorFunction"),rt(f),rt(f,o,"Generator"),rt(f,r,function(){return this}),rt(f,"toString",function(){return"[object Generator]"}),(nt=function(){return{w:a,m:p}})()}function rt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}rt=function(e,t,n,r){function a(t,n){rt(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},rt(e,t,n,r)}function ot(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function at(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){ot(a,r,o,i,c,"next",e)}function c(e){ot(a,r,o,i,c,"throw",e)}i(void 0)})}}document.addEventListener("DOMContentLoaded",at(nt().m(function e(){var t,r,o,a,i,c;return nt().w(function(e){for(;;)switch(e.p=e.n){case 0:if(l.addRoute("/",function(){g.isAuthenticated()?l.navigate("/home"):l.navigate("/login")}),l.addRoute("/login",at(nt().m(function e(){var t,n;return nt().w(function(e){for(;;)switch(e.n){case 0:return t=new j,n=new ae(t),e.n=1,n.init();case 1:return e.a(2)}},e)}))),l.addRoute("/register",at(nt().m(function e(){var t,n;return nt().w(function(e){for(;;)switch(e.n){case 0:return t=new T,n=new pe(t),e.n=1,n.init();case 1:return e.a(2)}},e)}))),l.addRoute("/home",at(nt().m(function e(){var t,n;return nt().w(function(e){for(;;)switch(e.n){case 0:return t=new D,n=new Ae(t),e.n=1,n.init();case 1:return e.a(2)}},e)}))),l.addRoute("/add",at(nt().m(function e(){var t,n;return nt().w(function(e){for(;;)switch(e.n){case 0:return t=new V,n=new We(t),e.n=1,n.init();case 1:return e.a(2)}},e)}))),l.addRoute("/favorites",at(nt().m(function e(){var t,n;return nt().w(function(e){for(;;)switch(e.n){case 0:if(g.isAuthenticated()){e.n=1;break}return l.navigate("/login"),e.a(2);case 1:return t=new $,n=new tt(t),e.n=2,n.init();case 2:return e.a(2)}},e)}))),l.addRoute("/404",at(nt().m(function e(){return nt().w(function(e){for(;;)switch(e.n){case 0:(new W).render();case 1:return e.a(2)}},e)}))),l.handleRoute(),!("serviceWorker"in navigator)){e.n=10;break}return e.p=1,e.n=2,navigator.serviceWorker.register("/sw.bundle.js");case 2:if(t=e.v,console.log("‚úÖ Service worker berhasil didaftarkan:",t),!g.isAuthenticated()){e.n=6;break}if(!(r=localStorage.getItem("token"))){e.n=6;break}return e.n=3,Promise.resolve().then(n.bind(n,602));case 3:return o=e.v,a=o.openDB,e.n=4,a("CeritaKuDB",1);case 4:return i=e.v,e.n=5,i.put("tokens",{key:"authToken",value:r});case 5:i.close();case 6:if(t.active){e.n=7;break}return e.n=7,new Promise(function(e){t.addEventListener("updatefound",function(){var n=t.installing;n.addEventListener("statechange",function(){"activated"===n.state&&e()})})});case 7:e.n=9;break;case 8:e.p=8,c=e.v,console.error("‚ùå Gagal mendaftarkan service worker:",c);case 9:e.n=11;break;case 10:console.log("Service Worker tidak didukung di browser ini.");case 11:return e.a(2)}},e,null,[[1,8]])})))})();